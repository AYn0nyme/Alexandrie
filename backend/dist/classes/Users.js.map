{"version":3,"file":"Users.js","sourceRoot":"","sources":["../../classes/Users.ts"],"names":[],"mappings":";;;AAAA,0DAA0B;AAC1B,mCAAiC;AAIjC,MAAqB,WAAY,SAAQ,cAAI;IAC3C,YAAY,GAAQ;QAClB,KAAK,CAAC,GAAG,CAAC,CAAC;IACb,CAAC;IACM,IAAI,CAAC,QAAgB,EAAE,QAAgB;QAC5C,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC;gBAAE,OAAO,MAAM,CAAC,4BAA4B,CAAC,CAAC;YACnG,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC;gBAAE,OAAO,MAAM,CAAC,4BAA4B,CAAC,CAAC;YACnG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAW,gDAAgD,EAAE,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE;gBAC/G,IAAI,GAAG;oBAAE,OAAO,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnD,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;oBAAE,OAAO,MAAM,CAAC,wBAAwB,CAAC,CAAC;gBACzD,MAAM,KAAK,GAAG,MAAM,IAAA,gBAAO,EAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;gBAC3D,IAAI,CAAC,KAAK;oBAAE,OAAO,MAAM,CAAC,wBAAwB,CAAC,CAAC;gBACpD,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;YACtB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;CACF;AAjBD,8BAiBC","sourcesContent":["import Base from './Base';\nimport { compare } from 'bcrypt';\nimport type { IObject, UserDB } from '../types';\nimport type { App } from '../app';\n\nexport default class MemberClass extends Base {\n  constructor(app: App) {\n    super(app);\n  }\n  public auth(username: string, password: string): Promise<IObject> {\n    return new Promise((resolve, reject) => {\n      if (!username || (username && username.trim() === '')) return reject('Username must be provided.');\n      if (!password || (password && password.trim() === '')) return reject('Password must be provided.');\n      this.app.db.query<UserDB[]>('SELECT * FROM users WHERE username = ? LIMIT 1', [username], async (err, results) => {\n        if (err) return reject('Internal database error.');\n        if (!results[0]) return reject('Bad username/password.');\n        const valid = await compare(password, results[0].password);\n        if (!valid) return reject('Bad username/password.');\n        resolve(results[0]);\n      });\n    });\n  }\n}\n"]}